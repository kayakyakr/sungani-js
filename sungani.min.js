// MIT License, see https://github.com/kayakyakr/sungani-js
(function(){try{Sungani}catch(a){Sungani={}}})(),function(){MicroEvent=function(){};var a=function(){this._events||Object.defineProperty(this,"_events",{value:{},enumerable:!1,configurable:!1})};MicroEvent.prototype={bind:function(b,c){a.call(this),this._events[b]=this._events[b]||[],this._events[b].push(c)},unbind:function(b,c){a.call(this);if(b in this._events==0)return;this._events[b].splice(this._events[b].indexOf(c),1)},trigger:function(b){a.call(this);if(b in this._events==0)return;for(var c=0;c<this._events[b].length;c++)this._events[b][c].apply(this,Array.prototype.slice.call(arguments,1))}},MicroEvent.mixin=function(a){var b=["bind","unbind","trigger"];for(var c=0;c<b.length;c++)Object.defineProperty(a.prototype,b[c],{value:MicroEvent.prototype[b[c]],enumerable:!1,configurable:!1})},typeof module!="undefined"&&"exports"in module&&(module.exports=MicroEvent)}(),function(){var a=function(a){};Object.defineProperties(a.prototype,{load_matches:{value:function(a){$.ajax({method:"GET",url:"/matches",dataType:"json",success:function(b,c,d){this.matches=b,a()}.bind(this)})},writeable:!1,configurable:!1},matches:{value:[],enumerable:!0},load:{value:function(a,b){$.ajax({method:"GET",url:"/games/"+a,dataType:"json",success:function(a,c,d){Object.apply(this,a),b&&b()}.bind(this)})},writeable:!1,configurable:!1},list:{value:function(a){$.ajax({method:"GET",url:"/games",dataType:"json",success:function(b,c,d){a(b)}.bind(this)})},writeable:!1,configurable:!1}}),Sungani.Game=new a}(),function(){var a=function(a){},b=null;MicroEvent.mixin(a),Object.defineProperties(a.prototype,{load:{value:function(a){var b={type:"GET",url:"/matches/"+a,dataType:"json",success:function(a,b,c){if(a.updated_at&&a.updated_at===this.updated_at)return;Object.apply(this,a),this.trigger("load")}.bind(this)};this.updated_at&&(b.data=b.data||{},b.data.updated_at=this.updated_at),$.ajax(b)},enumerable:!1,writeable:!1,configurable:!1},refresh:{value:function(){this.load(this.id)},enumerable:!1,writaeable:!1,configurable:!1},save:{value:function(){$.ajax({type:"PUT",url:"/matches/"+this.id,dataType:"json",data:{match:JSON.stringify(this)},success:function(a,b,c){Object.apply(this,a),this.trigger("save"),this.trigger("load")}.bind(this)})},writeable:!1,configurable:!1},create:{value:function(a,b){$.ajax({type:"POST",url:"/matches",dataType:"json",data:{game_id:a,users:b},success:function(a,b,c){Object.apply(this,a),this.trigger("create")}.bind(this)})},writeable:!1,configurable:!1},start_polling:{value:function(){if(b)return;b=setInterval(function(){this.refresh()}.bind(this),15e3)},writeable:!1,configurable:!1},stop_polling:{value:function(){clearInterval(b),b=null},writeable:!1,configurable:!1}}),Sungani.Match=new a}();